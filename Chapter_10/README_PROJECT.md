# Chapter 10: 금융 API를 활용한 금리 정보 수집 및 문서 생성

## 개요

이 챕터는 **"혼자 공부하는 파이썬"** 책의 내용을 기반으로, 금융감독원 FSS API와 한국은행 ECOS API를 활용하여 금융 상품 정보 및 금리 데이터를 수집하고, 수집한 데이터를 Word 문서로 자동 생성하는 프로젝트입니다.

또한, 책에서 배운 금융감독원 FSS API 사용법과 수업시간에 배운 GitHub Actions + crontab을 응용하여 금융권 채용 공고를 자동으로 수집하고 README에 업데이트하는 미니프로젝트도 포함되어 있습니다.

## 학습 내용

- **금융 API 활용**: 금융감독원 FSS API와 한국은행 ECOS API를 통한 금융 데이터 수집
- **데이터 수집**: 정기예금, 정기적금, 대출 금리 등 다양한 금융 상품 정보 수집
- **데이터 시각화**: 금리 추이를 그래프로 시각화
- **문서 자동 생성**: Python-docx를 활용한 Word 문서 자동 생성
- **자동화 미니프로젝트**: 책에서 배운 FSS API와 수업에서 배운 GitHub Actions + crontab을 응용한 채용 공고 자동 업데이트 시스템

## 프로젝트 구조

```
Chapter_10/
├── img/                 # 금리 추이 그래프 이미지 저장 디렉터리
│   ├── 산금채.png
│   ├── 정기예금.png
│   ├── 정기적금.png
│   ├── 일반신용대출.png
│   └── 주택담보대출.png
├── output/              # 결과 파일 저장 디렉터리
│   ├── step_1_2.xlsx   # 정기예금 상품 정보 (Excel)
│   ├── step_2_1.xlsx   # 주요 금리 지표 데이터 (Excel, 다중 시트)
│   ├── step_3_1.docx   # Word 문서 기본 템플릿
│   ├── step_3_2.docx   # 제목이 추가된 문서
│   ├── step_3_3.docx   # 주요 금리 현황이 추가된 문서
│   └── step_3_4.docx   # 정기예금 상품 정보가 추가된 최종 문서
├── .github/
│   └── workflows/
│       └── update_readme.yml  # GitHub Actions 워크플로우
├── step_1_1.py         # 디렉터리 생성
├── step_1_2.py         # 금융감독원 FSS API를 통한 정기예금 정보 수집
├── step_2_1.py         # ECOS API를 통한 주요 금리 지표 수집
├── step_2_2.py         # 금리 추이 그래프 생성
├── step_3_1.py         # Word 문서 기본 템플릿 생성
├── step_3_2.py         # 문서 제목 추가
├── step_3_3.py         # 주요 금리 현황 표 및 그래프 삽입
├── step_3_4.py         # 정기예금 상품 정보 표 삽입
└── update_jobs.py      # 금융권 채용 공고 수집 및 README 업데이트 스크립트
```

## 실행 순서

### 금리 정보 수집 및 문서 생성

1. **`step_1_1.py`**: `img`와 `output` 폴더를 생성합니다.
2. **`step_1_2.py`**: 금융감독원 FSS API를 통해 정기예금 상품 정보를 수집하여 Excel로 저장합니다.
3. **`step_2_1.py`**: ECOS API를 통해 주요 금리 지표(산금채, 정기예금, 정기적금, 일반신용대출, 주택담보대출)를 수집하여 Excel로 저장합니다.
4. **`step_2_2.py`**: 각 금리 지표의 최근 24개월 추이를 그래프로 시각화하여 이미지로 저장합니다.
5. **`step_3_1.py`**: Word 문서의 기본 템플릿을 생성합니다.
6. **`step_3_2.py`**: 문서에 제목을 추가합니다.
7. **`step_3_3.py`**: 주요 금리 현황 표와 그래프를 삽입합니다.
8. **`step_3_4.py`**: 정기예금 상품 정보 표를 삽입하여 최종 문서를 완성합니다.

### 채용 공고 자동 업데이트 (미니프로젝트)

이 기능은 책에서 배운 금융감독원 FSS API 사용법과 수업시간에 배운 GitHub Actions + crontab 스케줄링을 응용하여 만든 미니프로젝트입니다.

- **`update_jobs.py`**: 금융감독원 채용 정보 API를 호출하여 채용 공고를 수집하고 README를 업데이트합니다.
- GitHub Actions의 cron 스케줄을 활용하여 매주 월요일 자동으로 실행됩니다.

## 주요 기능

### 금융 데이터 수집
- 금융감독원 FSS API를 통한 정기예금 상품 정보 수집
- 한국은행 ECOS API를 통한 주요 금리 지표 수집
- 다양한 금융 상품의 금리 정보 조회

### 데이터 시각화
- 최근 24개월 금리 추이를 그래프로 시각화
- 상승/하락에 따른 색상 구분 (상승: 빨간색, 하락: 파란색)
- 최소값 기준 영역 채우기

### 문서 자동 생성
- Python-docx를 활용한 Word 문서 자동 생성
- 한글 폰트 설정 (Malgun Gothic)
- 표 삽입 및 스타일링
- 이미지 삽입 및 정렬

### 채용 공고 자동화 (미니프로젝트)
- 책에서 배운 금융감독원 FSS API를 활용한 채용 정보 수집
- 진행 중인 공고와 마감된 공고 구분
- 수업에서 배운 GitHub Actions + crontab을 응용한 자동 스케줄링

## 필요 라이브러리

- `datakart`: 공공 API 데이터 수집 라이브러리
- `pandas`: 데이터 처리 및 분석
- `matplotlib`: 그래프 시각화
- `python-docx`: Word 문서 생성
- `python-dotenv`: 환경 변수 관리
- `openpyxl`: Excel 파일 읽기/쓰기
- `requests`: HTTP 요청 (채용 공고 수집)

## 설정

프로젝트 실행 전, `.env` 파일을 생성하고 필요한 API 키를 입력해야 합니다:

```env
FSS_KEY="YOUR_FSS_API_KEY"
ECOS_KEY="YOUR_ECOS_API_KEY"
```

- FSS API 키: [금융감독원 공공데이터포털](https://www.fss.or.kr/)에서 발급
- ECOS API 키: [한국은행 경제통계시스템](https://ecos.bok.or.kr/)에서 발급

### GitHub Actions 설정

채용 공고 자동 업데이트를 사용하려면 GitHub Secrets에 다음을 설정해야 합니다:

- `FSS_API_KEY`: 금융감독원 채용 정보 API 키

## 참고사항

- 이 프로젝트는 학습 목적으로 작성되었습니다.
- API 호출 시 일일 제한이 있을 수 있으니 주의하세요.
- Word 문서 생성 시 한글 폰트가 설치되어 있어야 합니다.
- 채용 공고 자동 업데이트는 수업에서 배운 GitHub Actions의 cron 스케줄을 활용하여 매주 월요일 00:00 UTC(한국 시간 오전 9시)에 자동 실행됩니다.

